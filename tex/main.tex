\input{preamble}

\newcommand{\titlefr}{Étendre des interpréteurs par détournement, ou comment étendre des interpréteurs sans en modifier le code}
\newcommand{\subtitlefr}{Avec une application à des analyses dynamiques pour un interpréteur de JavaScript}
\newcommand{\titleen}{Extending interpreters by diverting, or how to extend interpreters without modifying their source code}

\title{\titlefr}
\author{fmdkdd}

%% Setup title, abstract, keywords used for the front and back covers.
\input{edstim-preamble}

\begin{document}

\begin{resume}
\input{abstract-fr}
\end{resume}

\begin{motscles}
Extensibilité, modularité, interpréteurs, instrumentation, patrons de
conception, programmation par objets, programmation par aspects, JavaScript
\end{motscles}

\begin{abstract_}
\input{abstract-en}
\end{abstract_}

\begin{keywords}
Extensibility, modularity, interpreters, instrumentation, Design Patterns,
Object-Oriented Programming, Aspect-Oriented Programming, JavaScript
\end{keywords}

%% Mandatory cover.  Not my fault!
\input{edstim-cover}

%% Insert title, TOC, and acknowledgments.  The Org document must not insert
%% title or TOC itself, otherwise they will appear before the frontmatter
%% command.

\frontmatter
\pagestyle{front}

\newgeometry{left=3.5cm,right=3.5cm,textheight=666pt}
\cleartorecto

%% Background image, per StackOverflow wisdom:
%% https://tex.stackexchange.com/questions/46280/how-to-create-a-background-image-on-title-page-with-latex
%% \AddToShipoutPicture*{\BackgroundPic}

\begin{flushleft}
{\LARGE\titlefr}\\
\vspace{\baselineskip}
{\Large\subtitlefr}
\end{flushleft}

\vspace{3cm}
\begin{flushright}
{\large\theauthor}
\end{flushright}

\vfill
\begin{center}
\includegraphics[width=1cm]{img/logo}
\end{center}

\vfill
\begin{center}
Version 1.0 du \today
\end{center}

%% \chapter*{Remerciements}
%% %% Fix heading mark showing “Contents”
%% %% as suggested here:
%% %% https://en.wikibooks.org/wiki/LaTeX/Document_Structure#The_document_environment
%% \markboth{\MakeUppercase{Remerciements}}{}
%% \cleardoublepage
%% \section*{Acknowledgements}
%% \input{acks}

%% Colophon
\cleartoverso
\phantom{a}                     % have to add phantom for \vspace to work
\vfill
\begin{minipage}{26pc}
\subsection*{Colophon}
Ce document a été produit par \LaTeX{}, engendré par Org 8.3.5 sous GNU Emacs
24.5.1.  La typographie est basée sur l'excellent paquet \texttt{memoir}; la
police du corps est Bitstream Charter, des titres \textsf{Fira Sans}
et \texttt{Fira Mono} pour le code.  Tous les diagrammes ont été faits avec
Inkscape 0.91.  Le code source complet est disponible sur
\href{https://github.com/fmdkdd/phd-manuscript}{github/fmdkdd/phd-manuscript}.

\vfill
\begin{center}
Ce document est placé dans le domaine public (license CC0).\\
\vspace{4pt}
\includegraphics[width=2cm]{img/cc-zero.png}
\end{center}
\end{minipage}

%% Abstract
\cleartorecto
\phantom{a}
\vfill
\begin{minipage}{26pc}
\section*{Résumé}
\input{abstract-fr}
\end{minipage}
\vfill
\phantom{a}

%% Table of contents
\cleartoverso
\tableofcontents*

\vfill

\begin{minipage}{0.8\textwidth}
\subsection*{À propos des mots de page}
\og Où diantre sont les numéros de page?\fg{} peut se demander le lecteur.  Il n'y en
a pas.  À la place il y a de mots qui, rangés par ordre lexicographique,
remplissent la même fonction.  \og Pourquoi diable?\fg{} rétorque-t-il.  Pour
écrire ce document, il m'a fallu choisir judicieusement ses soixante-cinq mille
mots, un par un.  Mais choisir chaque mot, c'était en éliminer des dizaines
d'autres, c'était les laisser sombrer dans l'oubli des pages vermoulues de mon
vieux Littré.  Pour apaiser ma conscience, j'ai choisi cent soixante-dix sept
mots qui trônent désormais aux coins des pages suivantes.  Choisis pour leur
sonorité, leur graphie, et parfois leur sens, je donne ainsi à ces mots, la
plupart désuets ou archaïques, une seconde chance.  Les numéros ont assez parlé,
place aux mots!
\end{minipage}
\restoregeometry

%% Main
\mainmatter
\pagestyle{companion}
\input{manuscript}

%% Back matter for bibliography, eventual index.
\backmatter

\newgeometry{left=2cm,right=3cm,textheight=636pt,bottom=2.9cm}
\printbibliography
\restoregeometry

%% Back cover is automatically inserted by a \AtEndDocument in edstim-preamble

\end{document}
